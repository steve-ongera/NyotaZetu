{% extends 'admin_base.html' %}
{% load humanize %}

{% block title %}User Guide - Nyota Zetu Bursary System{% endblock %}

{% block extra_css %}
<style>
    .breadcrumb {
        padding: 0;
        margin-bottom: 20px;
        font-size: 14px;
        list-style: none;
        display: flex;
        flex-wrap: wrap;
    }
    .breadcrumb-item { color: #64748B; }
    .breadcrumb-item + .breadcrumb-item::before {
        content: "/ ";
        color: #94A3B8;
        padding: 0 8px;
    }
    .breadcrumb-item.active { color: #1E293B; font-weight: 500; }
    .breadcrumb a { color: #3498db; text-decoration: none; }

    .page-header {
        background: linear-gradient(135deg, #27ae60 0%, #1e8449 100%);
        color: white;
        padding: 40px;
        border-radius: 12px;
        margin-bottom: 30px;
    }
    .page-header h1 {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 12px;
    }
    .page-header p { opacity: 0.9; font-size: 16px; margin: 0; }

    .section-title {
        font-size: 20px;
        font-weight: 600;
        color: #1E293B;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .section-title i { color: #3498db; }

    /* Quick Start Steps */
    .steps-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    .step-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        border: 1px solid #E2E8F0;
        position: relative;
        transition: all 0.3s ease;
    }
    .step-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    .step-number {
        position: absolute;
        top: -12px;
        left: 20px;
        width: 32px;
        height: 32px;
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 14px;
    }
    .step-icon {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        background: #F0F9FF;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: #3498db;
        margin-bottom: 16px;
    }
    .step-title {
        font-size: 16px;
        font-weight: 600;
        color: #1E293B;
        margin-bottom: 8px;
    }
    .step-description {
        font-size: 14px;
        color: #64748B;
        line-height: 1.5;
    }

    /* FAQ Section */
    .faq-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        border: 1px solid #E2E8F0;
        margin-bottom: 30px;
    }
    .faq-tabs {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-bottom: 24px;
        border-bottom: 1px solid #E2E8F0;
        padding-bottom: 16px;
    }
    .faq-tab {
        padding: 8px 16px;
        border-radius: 20px;
        background: #F8FAFC;
        color: #64748B;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        border: 1px solid #E2E8F0;
        transition: all 0.2s ease;
    }
    .faq-tab:hover, .faq-tab.active {
        background: #3498db;
        color: white;
        border-color: #3498db;
    }
    .faq-item {
        border: 1px solid #E2E8F0;
        border-radius: 8px;
        margin-bottom: 12px;
        overflow: hidden;
    }
    .faq-question {
        padding: 16px 20px;
        background: #F8FAFC;
        font-weight: 600;
        color: #1E293B;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.2s ease;
    }
    .faq-question:hover { background: #F0F9FF; }
    .faq-question i { color: #3498db; transition: transform 0.3s ease; }
    .faq-question.active i { transform: rotate(180deg); }
    .faq-answer {
        padding: 0 20px;
        max-height: 0;
        overflow: hidden;
        transition: all 0.3s ease;
        color: #64748B;
        line-height: 1.6;
    }
    .faq-answer.show {
        padding: 16px 20px;
        max-height: 500px;
    }

    /* Common Issues */
    .issues-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .issue-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        border-left: 4px solid #e74c3c;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    .issue-title {
        font-size: 15px;
        font-weight: 600;
        color: #e74c3c;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .issue-solution {
        font-size: 14px;
        color: #64748B;
        line-height: 1.5;
        padding-left: 24px;
        border-left: 2px solid #27ae60;
        margin-left: 8px;
    }

    /* Video Tutorials */
    .video-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .video-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid #E2E8F0;
        transition: all 0.3s ease;
    }
    .video-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    .video-thumbnail {
        height: 160px;
        background: linear-gradient(135deg, #1E293B, #334155);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }
    .play-btn {
        width: 60px;
        height: 60px;
        background: rgba(255,255,255,0.9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: #3498db;
        transition: all 0.3s ease;
    }
    .video-card:hover .play-btn {
        transform: scale(1.1);
        background: white;
    }
    .video-duration {
        position: absolute;
        bottom: 10px;
        right: 10px;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
    }
    .video-info {
        padding: 16px;
    }
    .video-title {
        font-size: 15px;
        font-weight: 600;
        color: #1E293B;
    }

    @media (max-width: 768px) {
        .page-header { padding: 24px; }
        .page-header h1 { font-size: 22px; }
        .steps-container { grid-template-columns: 1fr; }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'admin_dashboard' %}"><i class="bi bi-house-door"></i> Dashboard</a>
            </li>
            <li class="breadcrumb-item active">User Guide</li>
        </ol>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <h1><i class="bi bi-journal-text"></i> User Guide</h1>
        <p>Step-by-step instructions and frequently asked questions to help you navigate the system</p>
    </div>

    <!-- Quick Start Guide -->
    <h2 class="section-title"><i class="bi bi-rocket-takeoff"></i> Quick Start Guide</h2>
    <div class="steps-container">
        {% for step in quick_start_steps %}
        <div class="step-card">
            <div class="step-number">{{ step.step }}</div>
            <div class="step-icon"><i class="{{ step.icon }}"></i></div>
            <h3 class="step-title">{{ step.title }}</h3>
            <p class="step-description">{{ step.description }}</p>
        </div>
        {% endfor %}
    </div>

    <!-- Video Tutorials -->
    <h2 class="section-title"><i class="bi bi-play-circle"></i> Video Tutorials</h2>
    <div class="video-grid">
        {% for video in video_tutorials %}
        <a href="{{ video.url }}" class="video-card">
            <div class="video-thumbnail">
                <div class="play-btn"><i class="bi bi-play-fill"></i></div>
                <span class="video-duration">{{ video.duration }}</span>
            </div>
            <div class="video-info">
                <h4 class="video-title">{{ video.title }}</h4>
            </div>
        </a>
        {% endfor %}
    </div>

    <!-- FAQs -->
    <h2 class="section-title"><i class="bi bi-question-circle"></i> Frequently Asked Questions</h2>
    <div class="faq-container">
        <div class="faq-tabs">
            <span class="faq-tab active" data-category="all">All</span>
            {% for category, faqs in faq_categories.items %}
            <span class="faq-tab" data-category="{{ category }}">{{ category }}</span>
            {% endfor %}
        </div>
        
        <div class="faq-list">
            {% for category, faqs in faq_categories.items %}
                {% for faq in faqs %}
                <div class="faq-item" data-category="{{ category }}">
                    <div class="faq-question">
                        {{ faq.question }}
                        <i class="bi bi-chevron-down"></i>
                    </div>
                    <div class="faq-answer">{{ faq.answer }}</div>
                </div>
                {% endfor %}
            {% empty %}
                <div class="faq-item">
                    <div class="faq-question">
                        How do I apply for a bursary?
                        <i class="bi bi-chevron-down"></i>
                    </div>
                    <div class="faq-answer">To apply, log in to your account, navigate to "Applications" and click "New Application". Fill in all required fields and upload necessary documents.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        What documents do I need?
                        <i class="bi bi-chevron-down"></i>
                    </div>
                    <div class="faq-answer">Required documents include: National ID, admission letter, fee structure, academic transcripts, and guardian's ID. Orphans should include death certificates.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        How long does the review process take?
                        <i class="bi bi-chevron-down"></i>
                    </div>
                    <div class="faq-answer">Applications are typically reviewed within 2-4 weeks. You will receive SMS and email notifications about your application status.</div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Common Issues -->
    <h2 class="section-title"><i class="bi bi-exclamation-triangle"></i> Common Issues & Solutions</h2>
    <div class="issues-grid">
        {% for issue in common_issues %}
        <div class="issue-card">
            <div class="issue-title"><i class="bi bi-bug"></i> {{ issue.issue }}</div>
            <p class="issue-solution">{{ issue.solution }}</p>
        </div>
        {% endfor %}
    </div>

    <!-- Need More Help -->
    <div style="text-align: center; padding: 40px; background: #F8FAFC; border-radius: 12px; margin-top: 20px;">
        <h3 style="color: #1E293B; margin-bottom: 12px;">Still Need Help?</h3>
        <p style="color: #64748B; margin-bottom: 20px;">Our support team is ready to assist you</p>
        <a href="{% url 'contact_support' %}" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: #3498db; color: white; border-radius: 8px; text-decoration: none; font-weight: 600;">
            <i class="bi bi-headset"></i> Contact Support
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // FAQ Toggle
    document.querySelectorAll('.faq-question').forEach(q => {
        q.addEventListener('click', function() {
            this.classList.toggle('active');
            this.nextElementSibling.classList.toggle('show');
        });
    });

    // FAQ Tabs
    document.querySelectorAll('.faq-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.faq-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            const category = this.dataset.category;
            document.querySelectorAll('.faq-item').forEach(item => {
                item.style.display = (category === 'all' || item.dataset.category === category) ? 'block' : 'none';
            });
        });
    });
});
</script>
{% endblock %}