{% extends 'base.html' %}
{% load humanize %}

{% block title %}Reports - {{ constituency.name }}{% endblock %}

{% block content %}
<div class="page-container">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="{% url 'constituency_dashboard' %}">Dashboard</a>
        <span class="separator">/</span>
        <span class="current">Reports</span>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <h1>CDF Bursary Reports</h1>
        <p>Generate and download reports for {{ constituency.name }} Constituency</p>
    </div>

    <!-- Report Types Grid -->
    <div class="reports-grid">
        <!-- Beneficiary List -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-users"></i>
            </div>
            <div class="report-content">
                <h3>Beneficiary List</h3>
                <p>Complete list of all beneficiaries with allocation details</p>
            </div>
            <form method="get" action="{% url 'constituency_generate_beneficiary_list' %}">
                <div class="form-group">
                    <label for="beneficiary_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="beneficiary_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-download"></i> Generate Beneficiary List
                </button>
            </form>
        </div>

        <!-- Financial Report -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-money"></i>
            </div>
            <div class="report-content">
                <h3>Financial Report</h3>
                <p>Comprehensive financial summary with ward breakdown</p>
            </div>
            <form method="get" action="{% url 'constituency_financial_report' %}">
                <div class="form-group">
                    <label for="financial_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="financial_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-view"></i> View Financial Report
                </button>
            </form>
        </div>

        <!-- Applications Export -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-file"></i>
            </div>
            <div class="report-content">
                <h3>All Applications</h3>
                <p>Export all applications to Excel format</p>
            </div>
            <form method="get" action="{% url 'constituency_export_data' %}">
                <input type="hidden" name="type" value="all_applications">
                <div class="form-group">
                    <label for="all_apps_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="all_apps_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-download"></i> Export All Applications
                </button>
            </form>
        </div>

        <!-- Approved Applications Export -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-check"></i>
            </div>
            <div class="report-content">
                <h3>Approved Applications</h3>
                <p>Export approved applications only</p>
            </div>
            <form method="get" action="{% url 'constituency_export_data' %}">
                <input type="hidden" name="type" value="approved_only">
                <div class="form-group">
                    <label for="approved_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="approved_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-download"></i> Export Approved Only
                </button>
            </form>
        </div>

        <!-- Disbursed Applications Export -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-cash"></i>
            </div>
            <div class="report-content">
                <h3>Disbursed Applications</h3>
                <p>Export disbursed applications with payment details</p>
            </div>
            <form method="get" action="{% url 'constituency_export_data' %}">
                <input type="hidden" name="type" value="disbursed_only">
                <div class="form-group">
                    <label for="disbursed_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="disbursed_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-download"></i> Export Disbursed
                </button>
            </form>
        </div>

        <!-- Ward-wise Report -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-location"></i>
            </div>
            <div class="report-content">
                <h3>Ward-wise Summary</h3>
                <p>Breakdown of applications and allocations by ward</p>
            </div>
            <a href="{% url 'constituency_wards_overview' %}" class="btn btn-primary btn-block">
                <i class="icon-view"></i> View Ward Summary
            </a>
        </div>

        <!-- Bulk Cheques List -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-cheque"></i>
            </div>
            <div class="report-content">
                <h3>Bulk Cheques List</h3>
                <p>Printable list of all bulk cheques for collection</p>
            </div>
            <form method="get" action="{% url 'constituency_print_cheque_list' %}">
                <div class="form-group">
                    <label for="cheque_fiscal_year">Fiscal Year</label>
                    <select name="fiscal_year" id="cheque_fiscal_year" class="form-control" required>
                        <option value="">Select year</option>
                        {% for fy in fiscal_years %}
                        <option value="{{ fy.id }}">{{ fy.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="icon-print"></i> Print Cheque List
                </button>
            </form>
        </div>

        <!-- Analytics Report -->
        <div class="report-card">
            <div class="report-icon">
                <i class="icon-chart"></i>
            </div>
            <div class="report-content">
                <h3>Analytics Dashboard</h3>
                <p>Detailed analytics and insights on CDF bursary program</p>
            </div>
            <a href="{% url 'constituency_analytics' %}" class="btn btn-primary btn-block">
                <i class="icon-view"></i> View Analytics
            </a>
        </div>
    </div>

    <!-- Report Guidelines -->
    <div class="content-section">
        <h2>Report Guidelines</h2>
        <div class="guidelines-content">
            <h3>Generating Reports</h3>
            <ul>
                <li>Select the appropriate fiscal year for the report you want to generate</li>
                <li>Ensure you have the necessary permissions to access the data</li>
                <li>Reports are generated in real-time based on current database records</li>
                <li>Excel reports can be opened with Microsoft Excel, Google Sheets, or LibreOffice</li>
            </ul>

            <h3>Using Reports</h3>
            <ul>
                <li>Beneficiary lists can be used for transparency and public disclosure</li>
                <li>Financial reports help track budget utilization and planning</li>
                <li>Application exports are useful for analysis and record-keeping</li>
                <li>All report generation activities are logged for audit purposes</li>
            </ul>

            <h3>Data Privacy</h3>
            <ul>
                <li>Handle all reports containing personal information with care</li>
                <li>Do not share beneficiary data without proper authorization</li>
                <li>Store downloaded reports securely</li>
                <li>Delete old report files when no longer needed</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}